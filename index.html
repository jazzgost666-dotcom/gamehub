<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GameDev Space | Network</title>
    <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Rajdhani:wght@400;500;700&display=swap" rel="stylesheet">
    
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getDatabase, ref, set, push, onValue, update, increment, remove } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";

        const firebaseConfig = {
            apiKey: "AIzaSyAMHAKVot044psR421B_t-Ht5EmsueVS8A",
            authDomain: "game-dev-space.firebaseapp.com",
            databaseURL: "https://game-dev-space-default-rtdb.firebaseio.com",
            projectId: "game-dev-space",
            storageBucket: "game-dev-space.firebasestorage.app",
            messagingSenderId: "1073185335190",
            appId: "1:1073185335190:web:ae9ffd88cdf89f53cbdfb7"
        };

        const app = initializeApp(firebaseConfig);
        const db = getDatabase(app);
        window.db = db; window.dbRefs = { ref, set, push, onValue, update, increment, remove };
    </script>

    <style>
        :root { --p-color: #8b5cf6; --bg-dark: #07050f; }
        body { font-family: 'Rajdhani', sans-serif; background: var(--bg-dark); color: white; overflow-x: hidden; }
        
        /* ANIMA√á√ÉO G INTRO */
        #intro-screen { position: fixed; inset: 0; background: #000; z-index: 9999; display: flex; flex-direction: column; align-items: center; justify-content: center; }
        .intro-g { 
            font-family: 'Orbitron'; font-size: 180px; font-weight: 900; color: var(--p-color); 
            text-shadow: 0 0 50px var(--p-color);
            animation: gDrop 1.2s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards;
            opacity: 0;
        }
        @keyframes gDrop {
            0% { transform: translateY(-200px) scale(0.5); opacity: 0; filter: blur(10px); }
            100% { transform: translateY(0) scale(1); opacity: 1; filter: blur(0); }
        }

        .glass { background: rgba(255, 255, 255, 0.02); backdrop-filter: blur(20px); border: 1px solid rgba(139, 92, 246, 0.15); }
        
        /* AVATAR PADR√ÉO NO-CRINGE */
        .default-avatar {
            background: linear-gradient(135deg, #1e1b4b 0%, #4c1d95 100%);
            display: flex; align-items: center; justify-content: center; font-weight: bold; color: white; border: 2px solid var(--p-color);
        }

        .profile-banner { 
            width: 100%; height: 260px; border-radius: 30px; 
            background: radial-gradient(circle at top right, #1e1b4b, #07050f);
            border: 1px solid rgba(255,255,255,0.05); position: relative; overflow: hidden;
        }
        .profile-banner::after {
            content: ''; position: absolute; inset: 0;
            background: url('https://www.transparenttextures.com/patterns/carbon-fibre.png'); opacity: 0.2;
        }

        #game-viewer { display: none; position: fixed; inset: 0; background: #000; z-index: 1000; }
        .game-split { display: grid; grid-template-columns: 1fr 400px; height: calc(100vh - 70px); }

        .btn-neon { transition: 0.3s; box-shadow: 0 0 0px var(--p-color); }
        .btn-neon:hover { background: var(--p-color); box-shadow: 0 0 20px var(--p-color); color: black; }
        
        .custom-scroll::-webkit-scrollbar { width: 4px; }
        .custom-scroll::-webkit-scrollbar-thumb { background: var(--p-color); border-radius: 10px; }
    </style>
</head>
<body>

    <div id="intro-screen">
        <div class="intro-g" id="g-logo">G</div>
        <div class="mt-8 overflow-hidden h-4">
            <p class="text-[10px] tracking-[1.5em] text-purple-500 uppercase animate-pulse">Iniciando Protocolo Dev</p>
        </div>
    </div>

    <div id="main-hub" class="hidden">
        <header class="h-20 flex justify-between items-center px-10 glass sticky top-0 z-50">
            <div class="flex items-center gap-2">
                <div class="w-8 h-8 bg-purple-600 rounded flex items-center justify-center font-bold font-orbitron text-black">G</div>
                <h1 class="font-orbitron font-black text-xl tracking-tighter uppercase">Space</h1>
            </div>
            <div class="flex items-center gap-8">
                <nav class="hidden md:flex gap-6 text-[10px] font-bold tracking-widest text-gray-400">
                    <a href="#" class="hover:text-purple-500 transition">EXPLORAR</a>
                    <a href="#" class="hover:text-purple-500 transition">RANKING</a>
                    <a href="#" onclick="openModal('modal-credits')" class="hover:text-purple-500 transition">CR√âDITOS</a>
                </nav>
                <button onclick="openModal('modal-upload')" class="bg-white text-black px-6 py-2 rounded-full text-[10px] font-black hover:bg-purple-500 transition">UPLOAD</button>
                <div onclick="openModal('modal-profile')" id="nav-avatar" class="w-10 h-10 rounded-full cursor-pointer default-avatar text-xs"></div>
            </div>
        </header>

        <main class="container mx-auto py-10 px-6">
            <div class="relative mb-32">
                <div id="display-banner" class="profile-banner shadow-2xl"></div>
                <div id="display-avatar" class="w-32 h-32 rounded-full absolute -bottom-16 left-10 border-4 border-[#07050f] default-avatar text-2xl shadow-2xl"></div>
                <div class="absolute -bottom-14 left-48">
                    <h2 id="display-name" class="text-3xl font-black font-orbitron leading-none">DEVELOPER</h2>
                    <p class="text-purple-500 text-xs font-bold tracking-[0.3em] uppercase mt-2">N√≠vel 01 | Game Architect</p>
                </div>
            </div>

            <div class="flex items-center justify-between mb-12">
                <h3 class="font-orbitron text-xl font-black italic">PROJETOS RECENTES</h3>
                <div class="h-px flex-1 mx-10 bg-gradient-to-r from-purple-500/50 to-transparent"></div>
            </div>

            <div id="games-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                </div>
        </main>

        <footer class="p-10 border-t border-white/5 text-center text-gray-600">
            <p class="text-[10px] tracking-[0.5em] uppercase">GameDev Space &copy; 2024 | Powered by Firebase Realtime</p>
        </footer>
    </div>

    <div id="game-viewer">
        <div class="h-[70px] border-b border-white/10 flex justify-between items-center px-8">
            <button onclick="closeViewer()" class="text-[10px] font-black tracking-widest text-red-500">FECHAR SISTEMA [X]</button>
            <div class="text-center">
                <p id="v-title" class="font-orbitron font-bold text-purple-400 leading-none">TITLE</p>
                <p id="v-author" class="text-[9px] uppercase tracking-widest text-gray-500 mt-1">AUTHOR</p>
            </div>
            <div class="flex gap-4">
                <button id="like-btn" class="bg-white/5 px-4 py-2 rounded-lg border border-white/10 text-xs hover:bg-purple-600 transition">‚ù§Ô∏è <span id="v-likes">0</span></button>
                <button onclick="toggleFullscreen()" class="bg-white text-black px-4 py-2 rounded-lg text-[10px] font-black">FULLSCREEN</button>
            </div>
        </div>
        <div id="v-layout" class="game-split">
            <div class="relative bg-black">
                <iframe id="g-frame" class="w-full h-full border-0"></iframe>
                <button id="mini-btn" onclick="toggleFullscreen()" class="hidden absolute top-4 right-4 bg-purple-600 p-2 rounded">MINIMIZAR</button>
            </div>
            <div class="glass flex flex-col p-6 border-l border-white/10">
                <h4 class="font-orbitron text-[10px] text-purple-500 font-black mb-4">TERMINAL DE FEEDBACK</h4>
                <div id="c-list" class="flex-1 overflow-y-auto space-y-3 custom-scroll mb-4 pr-2"></div>
                <div class="flex gap-2">
                    <input type="text" id="c-input" placeholder="Digite sua mensagem..." class="flex-1 bg-white/5 border border-white/10 p-3 rounded-xl text-xs outline-none focus:border-purple-500">
                    <button onclick="postComment()" class="bg-purple-600 px-4 rounded-xl">‚ûî</button>
                </div>
            </div>
        </div>
    </div>

    <div id="modal-credits" class="hidden fixed inset-0 bg-black/95 z-[1000] flex items-center justify-center">
        <div class="glass p-10 rounded-[40px] max-w-lg text-center">
            <h3 class="font-orbitron text-2xl font-black text-purple-500 mb-6">SISTEMA DE CR√âDITOS</h3>
            <div class="space-y-4 text-sm text-gray-400">
                <p><b class="text-white">Lead Architect:</b> Voc√™ (Dev Master)</p>
                <p><b class="text-white">UI/UX Engine:</b> Gemini 1.5 & Tailwind</p>
                <p><b class="text-white">Backend:</b> Firebase Realtime DB</p>
                <p class="pt-6 text-[10px] uppercase tracking-widest">Agradecimentos √† comunidade GameDev pela colabora√ß√£o global.</p>
            </div>
            <button onclick="closeModal('modal-credits')" class="mt-8 bg-white text-black px-8 py-3 rounded-full font-black text-xs">VOLTAR</button>
        </div>
    </div>

    <div id="modal-upload" class="hidden fixed inset-0 bg-black/95 z-[1000] flex items-center justify-center p-4">
        <div class="glass p-8 rounded-[30px] w-full max-w-xl">
            <h3 class="font-orbitron text-xl font-bold text-purple-500 mb-6 uppercase tracking-tighter">Postar Novo Projeto</h3>
            <form onsubmit="handleUpload(event)" class="space-y-4">
                <input type="text" id="up-name" placeholder="T√≠tulo do Jogo" required class="w-full bg-white/5 border border-white/10 p-4 rounded-2xl outline-none focus:border-purple-500">
                <input type="text" id="up-capa" placeholder="URL da Capa" class="w-full bg-white/5 border border-white/10 p-4 rounded-2xl outline-none">
                <select id="up-type" class="w-full bg-white/5 border border-white/10 p-4 rounded-2xl outline-none">
                    <option value="url">Link Externo</option>
                    <option value="code">C√≥digo HTML</option>
                </select>
                <textarea id="up-content" placeholder="Link ou C√≥digo..." required class="w-full bg-white/5 border border-white/10 p-4 rounded-2xl h-32 outline-none focus:border-purple-500"></textarea>
                <div class="flex gap-2">
                    <button type="submit" class="flex-1 bg-purple-600 py-4 rounded-2xl font-black hover:bg-purple-500 transition">PUBLICAR AGORA</button>
                    <button type="button" onclick="closeModal('modal-upload')" class="px-6 bg-white/10 rounded-2xl font-bold">CANCELAR</button>
                </div>
            </form>
        </div>
    </div>

    <div id="modal-profile" class="hidden fixed inset-0 bg-black/95 z-[1000] flex items-center justify-center p-4">
        <div class="glass p-8 rounded-[30px] w-full max-w-md">
            <h3 class="font-orbitron text-xl font-bold text-center mb-6">MEU PERFIL</h3>
            <div class="space-y-4">
                <input type="text" id="p-name" placeholder="Seu Apelido" class="w-full bg-white/5 border border-white/10 p-4 rounded-2xl outline-none focus:border-purple-500">
                <input type="text" id="p-avatar" placeholder="URL da Foto (Deixe vazio para padr√£o)" class="w-full bg-white/5 border border-white/10 p-4 rounded-2xl outline-none">
                <input type="text" id="p-banner" placeholder="URL do Banner" class="w-full bg-white/5 border border-white/10 p-4 rounded-2xl outline-none">
                <button onclick="saveProfile()" class="w-full bg-purple-600 py-4 rounded-2xl font-black">ATUALIZAR IDENTIDADE</button>
                <button onclick="closeModal('modal-profile')" class="w-full text-xs text-gray-600 mt-2">FECHAR</button>
            </div>
        </div>
    </div>

    <script>
        let currentUser = JSON.parse(localStorage.getItem('gs_user')) || { 
            name: 'Dev_' + Math.floor(Math.random()*99), 
            avatar: '',
            banner: ''
        };
        let activeId = null;

        window.onload = () => {
            setTimeout(() => {
                document.getElementById('intro-screen').style.display = 'none';
                document.getElementById('main-hub').classList.remove('hidden');
                updateUI();
                loadGames();
            }, 3000);
        };

        function updateUI() {
            const navAv = document.getElementById('nav-avatar');
            const dispAv = document.getElementById('display-avatar');
            const nameDisp = document.getElementById('display-name');

            nameDisp.innerText = currentUser.name;
            
            if(currentUser.avatar) {
                navAv.style.backgroundImage = `url('${currentUser.avatar}')`;
                navAv.innerHTML = "";
                dispAv.style.backgroundImage = `url('${currentUser.avatar}')`;
                dispAv.innerHTML = "";
            } else {
                const initial = currentUser.name.charAt(0).toUpperCase();
                navAv.innerHTML = initial;
                navAv.style.backgroundImage = "none";
                dispAv.innerHTML = initial;
                dispAv.style.backgroundImage = "none";
            }

            if(currentUser.banner) {
                document.getElementById('display-banner').style.backgroundImage = `url('${currentUser.banner}')`;
            }
        }

        function saveProfile() {
            currentUser.name = document.getElementById('p-name').value || currentUser.name;
            currentUser.avatar = document.getElementById('p-avatar').value || currentUser.avatar;
            currentUser.banner = document.getElementById('p-banner').value || currentUser.banner;
            localStorage.setItem('gs_user', JSON.stringify(currentUser));
            updateUI();
            closeModal('modal-profile');
        }

        function handleUpload(e) {
            e.preventDefault();
            const { ref, push, set } = window.dbRefs;
            const newRef = push(ref(window.db, 'games'));
            set(newRef, {
                name: document.getElementById('up-name').value,
                capa: document.getElementById('up-capa').value,
                type: document.getElementById('up-type').value,
                content: document.getElementById('up-content').value,
                author: currentUser.name,
                likes: 0,
                views: 0,
                ts: Date.now()
            });
            closeModal('modal-upload');
            e.target.reset();
        }

        function loadGames() {
            const { ref, onValue } = window.dbRefs;
            onValue(ref(window.db, 'games'), (snap) => {
                const data = snap.val();
                const grid = document.getElementById('games-grid');
                grid.innerHTML = "";
                if(!data) return;
                Object.keys(data).reverse().forEach(id => {
                    const g = data[id];
                    grid.innerHTML += `
                        <div class="glass rounded-3xl overflow-hidden group cursor-pointer hover:scale-[1.02] transition" onclick="openViewer('${id}')">
                            <img src="${g.capa || 'https://images.unsplash.com/photo-1614850523296-d8c1af93d400'}" class="w-full h-44 object-cover">
                            <div class="p-5">
                                <h4 class="font-bold text-sm uppercase truncate">${g.name}</h4>
                                <div class="flex justify-between items-center mt-3 text-[10px] font-bold text-purple-400">
                                    <span>BY ${g.author}</span>
                                    <span>üëÅÔ∏è ${g.views || 0}</span>
                                </div>
                            </div>
                        </div>
                    `;
                });
            });
        }

        function openViewer(id) {
            const { ref, onValue, update, increment } = window.dbRefs;
            activeId = id;
            update(ref(window.db, `games/${id}`), { views: increment(1) });
            onValue(ref(window.db, `games/${id}`), (snap) => {
                const g = snap.val();
                if(!g) return;
                document.getElementById('v-title').innerText = g.name;
                document.getElementById('v-author').innerText = g.author;
                document.getElementById('v-likes').innerText = g.likes || 0;
                const fr = document.getElementById('g-frame');
                if(g.type === 'url') fr.src = g.content; else fr.srcdoc = g.content;
            });
            loadComments(id);
            document.getElementById('game-viewer').style.display = 'block';
            document.body.style.overflow = 'hidden';
        }

        function closeViewer() {
            document.getElementById('game-viewer').style.display = 'none';
            document.getElementById('g-frame').src = "";
            document.body.style.overflow = 'auto';
        }

        function toggleFullscreen() {
            const l = document.getElementById('v-layout');
            l.classList.toggle('fullscreen-active');
            l.style.gridTemplateColumns = l.classList.contains('fullscreen-active') ? "1fr" : "1fr 400px";
            document.getElementById('mini-btn').classList.toggle('hidden');
        }

        function postComment() {
            const input = document.getElementById('c-input');
            if(!input.value.trim() || !activeId) return;
            const { ref, push, set } = window.dbRefs;
            set(push(ref(window.db, `comments/${activeId}`)), {
                user: currentUser.name, text: input.value, ts: Date.now()
            });
            input.value = "";
        }

        function loadComments(id) {
            const { ref, onValue } = window.dbRefs;
            onValue(ref(window.db, `comments/${id}`), (snap) => {
                const list = document.getElementById('c-list');
                list.innerHTML = "";
                const data = snap.val();
                if(data) Object.values(data).forEach(c => {
                    list.innerHTML += `
                        <div class="bg-white/5 p-3 rounded-xl border border-white/5">
                            <p class="text-[9px] font-black text-purple-500 uppercase">${c.user}</p>
                            <p class="text-xs text-white/80">${c.text}</p>
                        </div>
                    `;
                });
            });
        }

        function openModal(id) { document.getElementById(id).classList.remove('hidden'); }
        function closeModal(id) { document.getElementById(id).classList.add('hidden'); }
    </script>
</body>
</html>
